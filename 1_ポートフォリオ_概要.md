# 競馬予測作成の目的
機械学習の処理の流れを学ぶため、学習データが軽量になりそうな競馬予測を選択  
個人利用する目的とサイトとして公開する予定  

# 開発期間
2022/10から着手し2022/12にversion1が完成  
開発工程は以下の通り  
- モデルの選定  
  高速であることとKaggleでよく使用されていることからLightGBMを採用
- 学習データのスクレイピング  
  scrapyを使用
  データの取りこぼしが多く一番時間がかかった  
- 精度の確認・改善  
  試作品ではアンダーサンプリングなどを行っておらず、データに偏りがあり見かけ上の精度が良くても重要な１着・２着・３着などの上位の予測結果が悪かった  
  version1では前処理を適切に行い精度としては落ちたが再現率が高いモデルができた  

# 予測モデルについて
LightGBMを使用して多クラス分類を行う  
## 【モデルの種類】
- 「1着・2着・3着・それ以外」の多クラス分類  
- 「1着・2着・3着・4着・5着・それ以外」の多クラス分類  
- 「1着・それ以外」の二値分類  
  ※精度が悪く修正予定

# 実行方法
colabで実行することを前提にしているため、実行コードはmain.ipynbを順次実行していく  
モデル自体は軽量で、ローカルで実行可能なためvscodeにJupiterNotebookを実行できる拡張機能をインストールすればローカルで実行可能  

# 環境
colabで実行する場合は意識する必要はなし  
ローカルで実行する場合はdockerで環境構築を行う

# ディレクトリ構造
```
.
├── dockerfile                    dockerfileの配置場所
├── src                           コードの配置場所
    ├── data                      データを保存するディレクトリ
    │   └── grades                レース結果を配置するディレクトリ
    │       ├── horse_grades      馬ごとのレース結果を配置するディレクトリ
    │       ├── master            マスターデータを保存するディレクトリ
    │       ├── model_parameter   モデルパラメータを保存するディレクトリ
    │       ├── pred              予測結果を保存するディレクトリ
    │       ├── tmp               一時的なデータを保存するディレクトリ
    │       ├── train_data        学習データを保存するディレクトリ
    │       └── url               スクレイピング対象urlを保存するディレクトリ
    ├── models                    モデルを保存するディレクトリ
    ├── modules                   モジュールを配置するディレクトリ
    │   └── constants             定数用モジュール
    │       ├── preprocess        前処理用モジュール
    │       └── training          学習用モジュール
    └── scrapy                    scrapyのプロジェクトを配置するディレクトリ
        └── keiba                 スクレイピング用プロジェクト
```
